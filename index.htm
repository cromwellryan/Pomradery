<html>
	<head>
		<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script src="/scripts/system"></script>
		<script src="/scripts/pomodoro"></script>
		<script>

			var host = document.location.origin;
			var socket = io.connect(host);
			var id = null;
			var pom = new pomodoro();

			var refresh = function() {
				var remaining = pom.remaining();
				var seconds = remaining.seconds < 10 ? "0" : "";
				seconds += remaining.seconds;

				$('#timeremaining').text(remaining.minutes + ':' + seconds);
			}

			socket.on('started', function (data) {
				pom.start(data.duration);
				id = setInterval( refresh, 1000 );
			});

			socket.on('remaining', function (data) {
				$("#timeremaining").html(data.duration + ":00");
			});

			socket.on('done', function (data) {
				if(id != null)
					clearInterval(id);

				$("#timeremaining").html("done");
			});

			$( function() {
				$("#start").click( function() { 	
					socket.emit('start');
				});

			});
		</script>
		<link rel="stylesheet" href="/styles/default" type="text/css"></link>
	</head>
	<body>
		<a id="start" href="#">Start</a>
		<div id="timeremaining"></div>
	</body>
</html>
